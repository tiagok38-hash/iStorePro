import{j as e,af as k,a1 as E,S as _,aH as T,ao as R,aN as M,f as i,Z as F,t as L}from"./index-BMA--0RW.js";import{r as h}from"./react-vendor-Bv8thS0I.js";const S=s=>new Date(s).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}),C=(s,b,x)=>{const m=new Date(s),d=x.find(j=>j.name===b);if(d&&d.days>0)return m.setDate(m.getDate()+d.days),m.toLocaleDateString("pt-BR");if(!b)return"";const r=b.match(/(\d+)\s+(mes|meses|ano|anos)/i);if(!r)return"";const p=parseInt(r[1],10),y=r[2].toLowerCase();return y.startsWith("mes")?m.setMonth(m.getMonth()+p):y.startsWith("ano")&&m.setFullYear(m.getFullYear()+p),m.toLocaleDateString("pt-BR")},$=({sale:s,productMap:b,customer:x,salesperson:m,companyInfo:d,activeTerm:r,totalPaid:p,totalItems:y,totalFees:j,warranties:u})=>{const o=a=>a?a.split(`
`).map((n,c)=>{const t=n.split(".");return t.length>1&&!isNaN(parseInt(t[0],10))?e.jsxs("li",{className:"flex",children:[e.jsxs("span",{className:"w-6 flex-shrink-0",children:[t[0],"."]}),e.jsx("span",{children:t.slice(1).join(".").trim()})]},c):e.jsx("li",{children:n},c)}):null;return e.jsxs("div",{className:"p-0 border-none font-sans text-black receipt-body",id:"receipt-content",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs",children:S(s.date)}),e.jsxs("span",{className:"font-semibold text-xs",children:["Recibo #",s.id," - ",d?.name]})]}),e.jsx("header",{className:"flex justify-between items-start pb-2 border-b border-black",children:e.jsxs("div",{className:"flex items-center gap-4",children:[d?.logoUrl&&e.jsx("img",{src:d.logoUrl,alt:d.name||"",className:"h-16 w-16 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-bold text-lg leading-tight",children:d?.name}),e.jsxs("div",{className:"text-[10px] leading-tight space-y-0.5",children:[e.jsxs("p",{children:["CNPJ: ",d?.cnpj]}),e.jsx("p",{children:d?.address}),e.jsxs("p",{children:[d?.city," (",d?.state,") CEP: ",d?.cep]})]})]})]})}),e.jsxs("section",{className:"flex justify-between items-start border-b border-black py-1.5",children:[e.jsxs("div",{className:"flex gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Data:"})," ",new Date(s.date).toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"ID:"})," #",s.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Caixa:"})," #",s.posTerminal.replace(/\D/g,"")||"N/A"]})]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-semibold",children:"Vendedor:"})," ",m?.name]})]}),e.jsxs("section",{className:"mt-1 py-1.5 border-b border-black",children:[e.jsx("h3",{className:"font-bold mb-0.5 text-xs",children:"DADOS DO CLIENTE"}),e.jsxs("div",{className:"flex flex-wrap gap-x-6 gap-y-0.5 text-xs",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Nome:"})," ",x?.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"CPF:"})," ",x?.cpf]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Tel:"})," ",x?.phone]}),x?.email&&e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",x?.email]})]})]}),s.observations&&e.jsxs("section",{className:"mt-1 py-1.5 border-b border-black",children:[e.jsx("h3",{className:"font-bold mb-0.5 text-xs",children:"OBSERVAÇÕES"}),e.jsx("p",{className:"text-xs",children:s.observations})]}),e.jsx("h2",{className:"font-bold text-center text-base my-2",children:"RECIBO DE VENDA"}),e.jsx("section",{children:e.jsxs("table",{className:"w-full text-left border-collapse border border-black mb-2 text-xs",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-1 py-0.5 font-semibold border border-black",children:"Descrição"}),e.jsx("th",{className:"px-1 py-0.5 font-semibold border border-black text-center w-10",children:"Qtd"}),e.jsx("th",{className:"px-1 py-0.5 font-semibold border border-black text-right w-20",children:"Unit."}),e.jsx("th",{className:"px-1 py-0.5 font-semibold border border-black text-right w-20",children:"Total"})]})}),e.jsx("tbody",{children:s.items.map(a=>{const n=b[a.productId],c=C(s.date,n?.warranty||"",u);return e.jsxs("tr",{children:[e.jsxs("td",{className:"px-1 py-0.5 align-top border border-black",children:[e.jsx("p",{className:"font-semibold leading-tight",children:`SKU:${n?.sku||""} ${n?.model||"Produto"}`}),e.jsxs("div",{className:"text-[10px] text-gray-600 leading-tight",children:[n?.imei1&&e.jsxs("span",{children:["IMEI1: ",n.imei1," "]}),n?.imei2&&e.jsxs("span",{children:["IMEI2: ",n.imei2," "]}),n?.serialNumber&&e.jsxs("span",{children:["S/N: ",n.serialNumber," "]}),e.jsx("span",{children:n?.condition})]}),c&&e.jsxs("p",{className:"text-[10px] text-gray-700 font-medium leading-tight mt-0.5",children:["Garantia válida até ",c,n?.batteryHealth?` • Saúde da Bateria: ${n.batteryHealth}%`:""]})]}),e.jsx("td",{className:"px-1 py-0.5 text-center align-top border border-black",children:a.quantity}),e.jsx("td",{className:"px-1 py-0.5 text-right align-top border border-black",children:i(a.unitPrice)}),e.jsx("td",{className:"px-1 py-0.5 text-right font-semibold align-top border border-black",children:i(a.unitPrice*a.quantity)})]},a.productId)})})]})}),e.jsxs("section",{className:"mt-1 flex justify-between items-start gap-4 text-xs",children:[e.jsxs("div",{className:"border border-black p-1.5 w-1/2 rounded",children:[e.jsx("p",{className:"font-bold mb-0.5 text-[11px]",children:"PAGAMENTO"}),e.jsx("div",{className:"space-y-0.5",children:s.payments.map(a=>{let n=a.method;return a.installments&&(n+=` (${a.installments}x ${i(a.installmentsValue)})`),a.feePercentage&&a.type!=="Sem Juros"&&(n+=` +${a.feePercentage.toFixed(2)}%`),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium leading-none",children:n}),a.tradeInDetails&&e.jsxs("p",{className:"pl-1 text-gray-600 italic text-[10px] leading-tight",children:["Troca: ",a.tradeInDetails.model,a.tradeInDetails.imei1?` IMEI:${a.tradeInDetails.imei1}`:` SN:${a.tradeInDetails.serialNumber}`]})]},a.id)})})]}),e.jsxs("div",{className:"w-1/3 space-y-0.5 bg-gray-50 p-1.5 rounded border border-gray-200 text-[11px]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"ITENS"}),e.jsx("span",{children:y})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"SUBTOTAL"}),e.jsx("span",{children:i(s.subtotal)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"DESCONTO"}),e.jsx("span",{children:i(s.discount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"TAXAS"}),e.jsx("span",{children:i(j)})]}),e.jsxs("div",{className:"flex justify-between border-t border-black pt-0.5 mt-0.5",children:[e.jsx("span",{className:"font-bold",children:"TOTAL"}),e.jsx("span",{className:"font-bold",children:i(s.total)})]}),e.jsxs("div",{className:"flex justify-between bg-black text-white px-1 rounded mt-0.5",children:[e.jsx("span",{className:"font-bold",children:"PAGO"}),e.jsx("span",{className:"font-bold",children:i(p)})]})]})]}),r&&e.jsxs("section",{className:"mt-2 space-y-1",children:[r.warrantyTerm?.showOnReceipt&&r.warrantyTerm.content&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-0.5 text-[10px]",children:"Garantia"}),e.jsx("p",{className:"whitespace-pre-wrap text-justify text-[9px] leading-tight",children:r.warrantyTerm.content})]}),r.warrantyExclusions?.showOnReceipt&&r.warrantyExclusions.content&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-0.5 mt-1 text-[10px]",children:"Não Coberto"}),e.jsx("ul",{className:"list-none space-y-0 text-[9px] leading-tight",children:o(r.warrantyExclusions.content)})]}),r.imageRights?.showOnReceipt&&r.imageRights.content&&e.jsxs("div",{className:"mt-1",children:[e.jsx("h3",{className:"font-bold uppercase border-b border-black mb-0.5 text-[10px]",children:"Direito de Imagem"}),e.jsx("p",{className:"whitespace-pre-wrap text-justify text-[9px] leading-tight",children:r.imageRights.content})]})]})]})},V=({sale:s,productMap:b,customer:x,salesperson:m,companyInfo:d,activeTerm:r,totalPaid:p,totalItems:y,totalFees:j,warranties:u})=>e.jsxs("div",{className:"w-[80mm] mx-auto p-2 bg-white text-black font-mono text-xs receipt-body",id:"receipt-content",children:[e.jsxs("div",{className:"text-center space-y-1",children:[d?.logoUrl&&e.jsx("img",{src:d.logoUrl,alt:"Logo",className:"h-24 mx-auto object-contain max-w-full"}),e.jsx("p",{className:"font-bold",children:d?.name}),e.jsx("p",{children:d?.address}),e.jsxs("p",{children:[d?.city," - ",d?.state]}),e.jsxs("p",{children:["CNPJ: ",d?.cnpj]})]}),e.jsx("div",{className:"border-t-2 border-dashed border-black my-2"}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("p",{children:["DATA: ",S(s.date)]}),e.jsxs("p",{children:["RECIBO: #",s.id]}),e.jsxs("p",{children:["VENDEDOR: ",m?.name||"N/A"]}),e.jsxs("p",{children:["CLIENTE: ",x?.name||"N/A"]}),x?.cpf&&e.jsxs("p",{children:["CPF: ",x.cpf]})]}),e.jsx("div",{className:"border-t-2 border-dashed border-black my-2"}),e.jsx("p",{className:"text-center font-bold",children:"RECIBO DE VENDA"}),e.jsx("div",{className:"border-t-2 border-dashed border-black my-2"}),e.jsx("div",{className:"space-y-1",children:s.items.map(o=>{const a=b[o.productId],n=C(s.date,a?.warranty||"",u);return e.jsxs("div",{className:"mb-1",children:[e.jsx("p",{className:"font-bold",children:a?.model||"Produto desconhecido"}),e.jsxs("div",{className:"flex justify-between text-[10px]",children:[e.jsxs("span",{children:[o.quantity," x ",i(o.unitPrice)]}),e.jsx("span",{children:i(o.unitPrice*o.quantity)})]}),e.jsxs("div",{className:"text-[9px] text-gray-700",children:[(a?.serialNumber||a?.imei1)&&e.jsxs("p",{children:[a.serialNumber&&`S/N: ${a.serialNumber} `,a.imei1&&`IMEI: ${a.imei1}`]}),n&&e.jsxs("p",{className:"font-semibold italic",children:["Garantia válida até ",n]})]})]},o.productId)})}),e.jsx("div",{className:"border-t border-dashed border-black my-2"}),e.jsxs("div",{className:"space-y-0.5 text-right",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-left",children:"Subtotal:"}),e.jsx("span",{children:i(s.subtotal)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-left",children:"Desconto:"}),e.jsx("span",{children:i(s.discount)})]}),j>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-left",children:"Acréscimos:"}),e.jsx("span",{children:i(j)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-sm",children:[e.jsx("span",{className:"text-left",children:"TOTAL:"}),e.jsx("span",{children:i(s.total)})]})]}),e.jsx("div",{className:"border-t border-dashed border-black my-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"PAGAMENTO:"}),s.payments.map(o=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[o.method,o.installments?` ${o.installments}x`:""]}),e.jsx("span",{children:i(o.value)})]}),o.tradeInDetails&&e.jsxs("p",{className:"text-[10px] pl-2",children:["* ",o.tradeInDetails.model," ",e.jsx("br",{}),o.tradeInDetails.imei1?`IMEI: ${o.tradeInDetails.imei1}`:`S/N: ${o.tradeInDetails.serialNumber}`]})]},o.id)),e.jsxs("div",{className:"flex justify-between font-bold mt-1",children:[e.jsx("span",{className:"text-left",children:"TOTAL PAGO:"}),e.jsx("span",{children:i(p)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-left",children:"TROCO:"}),e.jsx("span",{children:i(p-s.total>0?p-s.total:0)})]})]}),s.observations&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-t border-dashed border-black my-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"OBSERVAÇÕES:"}),e.jsx("p",{children:s.observations})]})]}),r&&e.jsxs("div",{className:"mt-2 pt-2 border-t-2 border-dashed border-black text-[8pt] space-y-2",children:[r.warrantyTerm?.showOnReceipt&&r.warrantyTerm.content&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-center text-xs uppercase",children:"Termos de Garantia"}),e.jsx("p",{className:"whitespace-pre-wrap",children:r.warrantyTerm.content})]}),r.warrantyExclusions?.showOnReceipt&&r.warrantyExclusions.content&&e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"font-bold text-center text-xs uppercase",children:"A Garantia não Cobre"}),e.jsx("p",{className:"whitespace-pre-wrap",children:r.warrantyExclusions.content})]}),r.imageRights?.showOnReceipt&&r.imageRights.content&&e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"font-bold text-center text-xs uppercase",children:"Direito de Imagem"}),e.jsx("p",{className:"whitespace-pre-wrap",children:r.imageRights.content})]})]}),e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("p",{children:"___________________________________"}),e.jsx("p",{children:x?.name||"Assinatura do Cliente"})]})]}),B=({sale:s,productMap:b,customers:x,users:m,onClose:d,format:r})=>{const[p,y]=h.useState(null),[j,u]=h.useState([]),[o,a]=h.useState([]),[n,c]=h.useState(!0);h.useEffect(()=>{(async()=>{c(!0);try{const[N,P,O]=await Promise.all([T(),R(),M()]);y(N),u(P),a(O)}catch(N){console.error("Failed to load receipt data",N)}finally{c(!1)}})()},[]);const t=h.useMemo(()=>x.find(f=>f.id===s.customerId),[x,s.customerId]),l=h.useMemo(()=>m.find(f=>f.id===s.salespersonId),[m,s.salespersonId]),g=h.useMemo(()=>s.payments.reduce((f,N)=>f+N.value,0),[s.payments]),w=h.useMemo(()=>s.payments.reduce((f,N)=>f+(N.fees||0),0),[s.payments]),I=h.useMemo(()=>s.items.reduce((f,N)=>f+N.quantity,0),[s.items]),v=h.useMemo(()=>{const f=j.find(N=>N.name==="IPHONE SEMINOVO");return j.find(N=>N.name===s.warrantyTerm)||f},[j,s.warrantyTerm]),A=()=>{window.print()},D={sale:s,productMap:b,customer:t,salesperson:l,companyInfo:p,activeTerm:v,totalPaid:g,totalItems:I,totalFees:w,warranties:o};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-start z-[60] py-8 px-4 print:p-0 print:bg-white overflow-y-auto",children:[e.jsx("style",{children:`
                    @media print {
                        body > * { visibility: hidden; }
                        #print-container, #print-container * { visibility: visible; }
                        #print-container {
                            position: absolute; left: 0; top: 0; width: 100%; height: auto;
                            padding: 0; margin: 0; border: none; box-shadow: none;
                        }
                        .no-print { display: none !important; }

                        ${r==="thermal"?`
                            @page { size: 80mm auto; margin: 2mm; }
                            .receipt-body { font-size: 9pt !important; color: black !important; width: 100%; }
                        `:`
                            @page { size: A4; margin: 10mm; }
                            .receipt-body { font-size: 10pt !important; color: black !important; }
                        `}

                        .whitespace-pre-wrap { white-space: pre-wrap; }
                    }
                `}),e.jsxs("div",{className:`bg-surface rounded-lg shadow-xl w-full ${r==="A4"?"max-w-3xl":"max-w-sm"} flex flex-col`,id:"print-container",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border no-print",children:[e.jsxs("h2",{className:"text-2xl font-bold text-primary",children:["Recibo da Venda #",s.id]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-md text-sm hover:bg-opacity-90",children:[e.jsx(k,{className:"h-5 w-5"})," Imprimir"]}),e.jsx("button",{onClick:d,className:"p-1 text-muted hover:text-danger",children:e.jsx(E,{className:"h-6 w-6"})})]})]}),e.jsx("div",{className:"p-2 sm:p-6",children:n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(_,{})}):r==="A4"?e.jsx($,{...D}):e.jsx(V,{...D})})]})]})},H=s=>new Date(s).toLocaleString("pt-BR",{dateStyle:"short",timeStyle:"short"}),q=({sale:s,productMap:b,customers:x,users:m,onClose:d})=>{const[r,p]=h.useState(!1),[y,j]=h.useState(null),u=h.useMemo(()=>x.find(t=>t.id===s.customerId),[x,s.customerId]),o=h.useMemo(()=>m.find(t=>t.id===s.salespersonId),[m,s.salespersonId]),a=h.useMemo(()=>s.payments.reduce((t,l)=>t+l.value,0),[s.payments]),n=h.useMemo(()=>s.payments.find(t=>t.method==="Aparelho na Troca"),[s.payments]),c=h.useMemo(()=>{if(n?.tradeInDetails||!n||!u?.tradeInHistory||u.tradeInHistory.length===0)return null;const t=new Date(s.date).getTime();let l=null,g=1/0;for(const w of u.tradeInHistory){const I=new Date(w.date).getTime(),v=Math.abs(t-I);v<g&&(g=v,l=w)}return l&&g<300*1e3&&b[l.productId]||null},[n,u,s.date,b]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-[60] p-4",children:e.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-border",children:[e.jsxs("h2",{className:"text-2xl font-bold text-primary",children:["Detalhes da Venda #",s.id]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-4 py-2 bg-primary text-white rounded-md text-sm hover:bg-opacity-90",children:[e.jsx(k,{className:"h-5 w-5"})," Imprimir"]}),e.jsx("button",{onClick:d,className:"p-1 text-muted hover:text-danger",children:e.jsx(E,{className:"h-6 w-6"})})]})]}),e.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 text-sm p-5 bg-surface-secondary rounded-xl border border-gray-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Data"}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:H(s.date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Vendedor"}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:o?.name||"N/A"})]}),s.origin==="PDV"&&s.cashSessionDisplayId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Cliente"}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:u?.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Caixa"}),e.jsxs("p",{className:"text-base font-bold text-gray-900",children:["#",s.cashSessionDisplayId]})]})]}):e.jsxs("div",{className:"col-span-full",children:[e.jsx("p",{className:"font-bold text-gray-500 mb-1 uppercase text-xs tracking-wider",children:"Cliente"}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:u?.name||"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-primary mb-2",children:"Itens Vendidos"}),e.jsx("div",{className:"border border-border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-xs text-secondary uppercase bg-surface-secondary",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Produto"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Qtd."}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Preço Unit."}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{className:"text-muted",children:s.items.map(t=>{const l=b[t.productId];return e.jsxs("tr",{className:"border-t border-border",children:[e.jsxs("td",{className:"px-4 py-2 text-primary align-top",children:[e.jsx("div",{className:"font-bold text-base",children:l?.model||"Produto desconhecido"}),l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-muted font-normal mt-1 flex flex-wrap items-center gap-x-2",children:[l.serialNumber&&e.jsxs("span",{children:["S/N: ",l.serialNumber]}),l.imei1&&e.jsxs(e.Fragment,{children:[l.serialNumber&&e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{children:["IMEI: ",l.imei1]})]}),l.condition&&e.jsxs(e.Fragment,{children:[(l.serialNumber||l.imei1)&&e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{children:["Condição: ",e.jsx("span",{className:"font-semibold",children:l.condition})]})]}),l.condition==="Seminovo"&&typeof l.batteryHealth=="number"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{children:["Bateria: ",e.jsxs("span",{className:"font-semibold",children:[l.batteryHealth,"%"]})]})]})]}),l.variations&&l.variations.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:l.variations.map((g,w)=>e.jsxs("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:[g.gradeName,": ",g.valueName]},g.gradeId||w))})]})]}),e.jsx("td",{className:"px-4 py-2 text-center align-top",children:t.quantity}),e.jsx("td",{className:"px-4 py-2 text-right align-top",children:i(t.unitPrice)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold text-primary align-top",children:i(t.unitPrice*t.quantity)})]},t.productId)})})]})})]}),e.jsxs("div",{className:"pt-4 border-t border-border grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-primary mb-2",children:"Detalhes do Pagamento"}),e.jsx("div",{className:"space-y-2 text-sm",children:s.payments.map(t=>{if(t.method==="Crédito"&&t.installments){const l=t.value||0,g=t.type==="Com Juros";return e.jsxs("div",{className:"p-3 bg-surface-secondary rounded-md text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"font-medium text-primary",children:t.method}),e.jsx("span",{className:"font-semibold",children:i(l)})]}),e.jsxs("div",{className:"pl-4 border-l-2 border-gray-200 ml-1 space-y-1 text-xs text-muted",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Parcelas:"}),e.jsxs("span",{className:"font-medium",children:[t.installments,"x de ",i(t.installmentsValue)]})]}),t.type!=="Sem Juros"&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[g?"Juros":"Taxa do Vendedor"," (",t.feePercentage?.toFixed(2),"%):"]}),e.jsx("span",{className:"font-medium",children:i(t.fees)})]})]})]},t.id)}return e.jsxs("div",{className:"p-3 bg-surface-secondary rounded-md",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"font-medium text-primary",children:t.method}),e.jsx("span",{className:"font-semibold",children:i(t.value)})]}),t.tradeInDetails&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 text-xs text-muted space-y-0.5",children:[e.jsx("p",{className:"font-semibold text-primary",children:t.tradeInDetails.model}),e.jsxs("p",{children:[t.tradeInDetails.imei1?`IMEI: ${t.tradeInDetails.imei1}`:`S/N: ${t.tradeInDetails.serialNumber}`,t.tradeInDetails.batteryHealth?` | Bateria: ${t.tradeInDetails.batteryHealth}%`:""]})]})]},t.id)})})]}),c&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-primary mb-2",children:"Aparelho Recebido na Troca (Histórico)"}),e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm space-y-1 text-primary",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Modelo:"})," ",c.model]}),e.jsxs("div",{className:"text-xs text-blue-800/80 font-normal mt-1 flex flex-wrap items-center gap-x-2",children:[c.serialNumber&&e.jsxs("span",{children:["S/N: ",c.serialNumber]}),c.imei1&&e.jsxs(e.Fragment,{children:[c.serialNumber&&e.jsx("span",{className:"text-blue-300",children:"|"}),e.jsxs("span",{children:["IMEI: ",c.imei1]})]}),c.condition&&e.jsxs(e.Fragment,{children:[(c.serialNumber||c.imei1)&&e.jsx("span",{className:"text-blue-300",children:"|"}),e.jsxs("span",{children:["Condição: ",e.jsx("span",{className:"font-semibold",children:c.condition})]})]}),c.condition==="Seminovo"&&typeof c.batteryHealth=="number"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-blue-300",children:"|"}),e.jsxs("span",{children:["Bateria: ",e.jsxs("span",{className:"font-semibold",children:[c.batteryHealth,"%"]})]})]})]}),c.variations&&c.variations.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1.5",children:c.variations.map((t,l)=>e.jsxs("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full bg-blue-100 text-blue-700 border border-blue-200",children:[t.gradeName,": ",t.valueName]},t.gradeId||l))}),e.jsxs("p",{className:"font-semibold mt-2",children:["Valor Creditado: ",i(n?.value)]})]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-2 bg-surface-secondary rounded-md",children:[e.jsx("span",{className:"text-muted",children:"Subtotal:"}),e.jsx("span",{className:"font-medium",children:i(s.subtotal)})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-surface-secondary rounded-md",children:[e.jsx("span",{className:"text-muted",children:"Desconto:"}),e.jsxs("span",{className:"font-medium text-danger",children:["-",i(s.discount)]})]}),e.jsxs("div",{className:"flex justify-between mt-2 pt-2 border-t border-border p-2",children:[e.jsx("span",{className:"font-semibold text-base text-primary",children:"Total da Venda:"}),e.jsx("span",{className:"font-bold text-xl text-primary",children:i(s.total)})]}),e.jsxs("div",{className:"flex justify-between p-2 bg-green-50 rounded-md",children:[e.jsx("span",{className:"text-muted",children:"Total Pago:"}),e.jsx("span",{className:"font-medium text-success",children:i(a)})]})]})]}),s.observations&&e.jsxs("div",{className:"pt-4 border-t border-border",children:[e.jsx("h3",{className:"font-semibold text-primary mb-2",children:"Observações (Comprovante)"}),e.jsx("p",{className:"text-sm p-3 bg-yellow-50 border border-yellow-200 rounded-lg whitespace-pre-wrap",children:s.observations})]}),s.internalObservations&&e.jsxs("div",{className:"pt-4 border-t border-border",children:[e.jsx("h3",{className:"font-semibold text-primary mb-2",children:"Observações Internas"}),e.jsx("p",{className:"text-sm p-3 bg-gray-50 border border-gray-200 rounded-lg italic text-gray-600 whitespace-pre-wrap",children:s.internalObservations})]})]}),e.jsx("div",{className:"flex justify-end items-center p-4 border-t border-border mt-auto",children:e.jsx("button",{onClick:d,className:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Fechar"})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-[70]",children:e.jsxs("div",{className:"bg-surface p-6 rounded-lg shadow-xl w-full max-w-sm",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-primary",children:"Escolha o Formato de Impressão"}),e.jsxs("p",{className:"text-sm text-muted mb-6",children:["Selecione o layout para o recibo da venda #",s.id,"."]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("button",{onClick:()=>{j("A4"),p(!1)},className:"w-full text-left flex items-center gap-4 p-4 border rounded-lg hover:bg-surface-secondary hover:border-accent",children:[e.jsx(F,{className:"h-8 w-8 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Formato A4"}),e.jsx("p",{className:"text-xs text-muted",children:"Layout padrão para impressoras comuns."})]})]}),e.jsxs("button",{onClick:()=>{j("thermal"),p(!1)},className:"w-full text-left flex items-center gap-4 p-4 border rounded-lg hover:bg-surface-secondary hover:border-accent",children:[e.jsx(L,{className:"h-8 w-8 text-accent"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Cupom 80mm"}),e.jsx("p",{className:"text-xs text-muted",children:"Layout para impressoras térmicas."})]})]})]}),e.jsx("button",{onClick:()=>{p(!1)},className:"mt-6 w-full px-4 py-2 bg-gray-200 text-secondary rounded-md hover:bg-gray-300",children:"Cancelar"})]})}),y&&e.jsx(B,{sale:s,format:y,productMap:b,customers:x,users:m,onClose:()=>j(null)})]})};export{q as S,B as a};
