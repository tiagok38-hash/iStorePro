import{j as e,S as j,aJ as k,am as I,ag as R}from"./index-BMA--0RW.js";import{r as a}from"./react-vendor-Bv8thS0I.js";const E=({isOpen:n,onClose:o,onCapture:m})=>{const r=a.useRef(null),i=a.useRef(null),[l,u]=a.useState(null),[s,p]=a.useState(null),[d,x]=a.useState(null),[h,b]=a.useState(!0),f=a.useCallback(async()=>{b(!0),x(null),p(null);try{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});u(t),r.current&&(r.current.srcObject=t)}else x("A câmera não é suportada neste navegador.")}catch(t){console.error(t),x("Não foi possível acessar a câmera. Verifique as permissões do seu navegador.")}finally{b(!1)}},[]),g=a.useCallback(()=>{l&&(l.getTracks().forEach(t=>t.stop()),u(null))},[l]);a.useEffect(()=>(n?f():g(),()=>{g()}),[n,f,g]);const y=()=>{if(r.current&&i.current){const t=r.current,c=i.current;c.width=t.videoWidth,c.height=t.videoHeight;const v=c.getContext("2d");if(v){v.drawImage(t,0,0,c.width,c.height);const C=c.toDataURL("image/jpeg");p(C),g()}}},w=()=>{f()},N=()=>{s&&m(s)};return n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-[80]",onClick:o,children:e.jsxs("div",{className:"bg-surface rounded-lg shadow-xl w-full max-w-lg flex flex-col",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"text-lg font-bold text-primary",children:"Tirar foto"})}),e.jsxs("div",{className:"p-4 flex-1 flex items-center justify-center bg-black min-h-[300px]",children:[d&&e.jsx("div",{className:"text-center text-danger p-4",children:d}),h&&!d&&e.jsx(j,{}),!h&&!d&&e.jsxs(e.Fragment,{children:[e.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-auto ${s?"hidden":"block"}`}),e.jsx("canvas",{ref:i,className:"hidden"}),s&&e.jsx("img",{src:s,alt:"Captured",className:"w-full h-auto"})]})]}),e.jsx("div",{className:"p-4 flex justify-center items-center gap-4 border-t",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-gray-200 text-secondary rounded-md hover:bg-gray-300",children:[e.jsx(I,{className:"h-5 w-5"})," Tirar outra"]}),e.jsxs("button",{onClick:N,className:"flex items-center gap-2 px-4 py-2 bg-success text-white rounded-md hover:bg-success/90",children:[e.jsx(R,{className:"h-5 w-5"})," Usar foto"]})]}):e.jsx("button",{onClick:y,disabled:h||!!d,className:"p-4 bg-primary text-white rounded-full disabled:bg-muted",children:e.jsx(k,{className:"h-6 w-6"})})})]})}):null},P=({loading:n,children:o,icon:m,variant:r="primary",className:i="",disabled:l,...u})=>{const s={primary:"bg-gray-800 text-white hover:bg-gray-900",secondary:"bg-white text-gray-800 border border-gray-300 hover:bg-gray-50",danger:"bg-danger text-white hover:bg-danger/90",success:"bg-success text-white hover:bg-success/90",ghost:"bg-transparent text-gray-600 hover:bg-gray-100"};return e.jsx("button",{className:`
                flex items-center justify-center gap-2 px-4 py-2 rounded-md font-medium text-sm
                transition-all duration-200 active:scale-95 
                disabled:opacity-70 disabled:cursor-not-allowed
                ${s[r]}
                ${i}
            `,disabled:n||l,...u,children:n?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 text-current animate-spin",style:{width:"1rem",height:"1rem"}}),e.jsx("span",{children:typeof o=="string"?"Processando...":o})]}):e.jsxs(e.Fragment,{children:[m,o]})})};export{P as B,E as C};
